You are about to enter plan mode to research and design an implementation plan.

{{input}}

## Plan Mode Guidelines

In plan mode, you should:

1. **Research Phase**
   - Thoroughly explore the codebase to understand existing patterns and architecture
   - Identify all relevant files, functions, and dependencies
   - Document current implementation details

2. **Design Phase**
   - Break down the task into clear, actionable steps
   - Identify potential challenges, edge cases, and technical constraints
   - Consider multiple approaches and trade-offs
   - Design the solution architecture

3. **Documentation Phase**
   - Create a detailed implementation plan with:
     - Clear step-by-step instructions
     - File paths and specific locations to modify
     - Code structure and API designs
     - Testing strategy
     - Potential risks and mitigation strategies

4. **Output Requirements**
   - Provide a complete, unambiguous plan that another developer could follow
   - Include specific file paths, function names, and line numbers where relevant
   - Document all assumptions and decisions made
   - List any questions or clarifications needed before implementation

**Important**: Focus on thorough planning and research. Do NOT make any code changes in plan mode. The goal is to create a comprehensive design document that will guide the implementation phase.
